{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ResearchMate ‚Äî Student Profile</title>
  <style>
    :root {
      --navy: #003366;
      --light-bg: #f5f3ed;
      --card-bg: #ffffff;
      --text-dark: #2c3e50;
      --text-muted: #6c757d;
      --border-color: #e0ddd5;
      --shadow: 0 4px 12px rgba(0, 51, 102, 0.08);
    }

    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
    }

    body {
      font-family: 'Inter', 'Segoe UI', 'Arial', sans-serif;
      background: var(--light-bg);
      color: var(--text-dark);
    }

    /* Top Navigation */
    .top-nav {
      background: var(--card-bg);
      padding: 16px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border-color);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .top-nav .logo {
      font-size: 24px;
      font-weight: 800;
      color: var(--navy);
      letter-spacing: -0.5px;
    }

    .nav-links {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .nav-links a {
      padding: 10px 20px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      text-decoration: none;
      font-size: 14px;
      font-weight: 600;
      border-radius: 8px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-links a:hover {
      background: var(--light-bg);
      color: var(--navy);
    }

    .nav-links a.active {
      background: var(--navy);
      color: white;
    }

    .user-section {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .user-section .student-label {
      color: var(--navy);
      font-weight: 600;
      font-size: 14px;
    }

    .logout-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 10px 18px;
      background: transparent;
      border: 2px solid var(--navy);
      color: var(--navy);
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: var(--navy);
      color: white;
    }

    /* Main Content */
    .main-content {
      max-width: 1000px;
      margin: 0 auto;
      padding: 40px;
    }

    .page-header {
      margin-bottom: 32px;
    }

    .page-header h1 {
      font-size: 36px;
      font-weight: 800;
      color: var(--navy);
      margin-bottom: 8px;
    }

    .page-header p {
      font-size: 16px;
      color: var(--text-muted);
    }

    /* Profile Grid */
    .profile-grid {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 24px;
      margin-bottom: 32px;
    }

    /* Profile Card */
    .profile-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 28px;
      text-align: center;
    }

    .profile-avatar {
      width: 120px;
      height: 120px;
      background: var(--navy);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      font-weight: 800;
      margin: 0 auto 20px;
    }

    .profile-card h3 {
      font-size: 20px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 6px;
    }

    .profile-card .role {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 20px;
    }

    .profile-card .info-item {
      text-align: left;
      padding: 12px 0;
      border-bottom: 1px solid var(--border-color);
    }

    .profile-card .info-item:last-child {
      border-bottom: none;
    }

    .profile-card .info-label {
      font-size: 12px;
      color: var(--text-muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .profile-card .info-value {
      font-size: 14px;
      color: var(--text-dark);
      font-weight: 600;
    }

    /* Form Card */
    .form-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 32px;
    }

    .form-card h2 {
      font-size: 22px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-color);
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-group label {
      display: block;
      font-size: 13px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      color: var(--text-dark);
      transition: all 0.3s ease;
      background: white;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--navy);
      box-shadow: 0 0 0 3px rgba(0, 51, 102, 0.1);
    }

    .form-actions {
      display: flex;
      gap: 12px;
      margin-top: 32px;
    }

    .btn-primary {
      flex: 1;
      padding: 14px 24px;
      background: var(--navy);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: #004080;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 51, 102, 0.3);
    }

    .btn-secondary {
      padding: 14px 24px;
      background: transparent;
      color: var(--text-muted);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 700;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      border-color: var(--navy);
      color: var(--navy);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .top-nav {
        flex-direction: column;
        gap: 16px;
        padding: 16px 20px;
      }

      .nav-links {
        flex-wrap: wrap;
        justify-content: center;
      }

      .main-content {
        padding: 20px;
      }

      .page-header h1 {
        font-size: 28px;
      }

      .profile-grid {
        grid-template-columns: 1fr;
      }

      .form-actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <nav class="top-nav">
    <div class="logo">ResearchMate</div>
    
    <div class="nav-links">
      <a href="{% url 'student_dashboard' %}">üè† Dashboard</a>
      <a href="{% url 'student_profile' %}" class="active">üë§ Profile</a>
      <a href="{% url 'bookings' %}">üìÖ Bookings</a>
      <a href="{% url 'student_history' %}">üìú History</a>
      <a href="#">‚ùì Help</a>
    </div>

    <div class="user-section">
      <span class="student-label">Student</span>
      <form method="POST" action="{% url 'logout' %}" style="display: inline;">
        {% csrf_token %}
        <button type="submit" class="logout-btn">üö™ Logout</button>
      </form>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <h1>Student Profile</h1>
      <p>Update your information to be displayed in your dashboard</p>
    </div>

    <!-- Profile Grid -->
    <div class="profile-grid">
      <!-- Profile Info Card -->
      <div class="profile-card">
        <div class="profile-avatar">ST</div>
        <h3 id="displayName">Student</h3>
        <p class="role">Undergraduate Student</p>
        
        <div class="info-item">
          <div class="info-label">Department</div>
          <div class="info-value" id="displayDept">Not set</div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Program</div>
          <div class="info-value" id="displayProgram">Not set</div>
        </div>
        
        <div class="info-item">
          <div class="info-label">Year Level</div>
          <div class="info-value" id="displayYear">Not set</div>
        </div>
      </div>

      <!-- Edit Form -->
      <div class="form-card">
        <h2>Edit Profile Information</h2>
        <form id="profileForm">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input type="text" id="fullName" placeholder="Enter your full name" required>
          </div>

          <div class="form-group">
            <label for="department">Department</label>
            <select id="department" required>
              <option value="">Select Department</option>
              <option value="CCS">College of Computer Studies</option>
              <option value="CEA">College of Engineering and Architecture</option>
              <option value="CMBA">College of Management, Business & Accountancy</option>
              <option value="CAS">College of Arts, Sciences, & Education</option>
              <option value="CNAHS">College of Nursing & Allied Health Sciences</option>
              <option value="CCJ">College of Criminal Justice</option>
            </select>
          </div>

          <div class="form-group">
            <label for="program">Program</label>
            <select id="program" required>
              <option value="">Select Program</option>
            </select>
          </div>

          <div class="form-group">
            <label for="yearLevel">Year Level</label>
            <select id="yearLevel" required>
              <option value="">Select Year Level</option>
              <option value="1">1st Year</option>
              <option value="2">2nd Year</option>
              <option value="3">3rd Year</option>
              <option value="4">4th Year</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn-primary">üíæ Save Changes</button>
            <button type="button" class="btn-secondary" onclick="window.location.href='{% url 'student_dashboard' %}'">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <script>
    // Programs by department
    const programsByDept = {
      "CCS": ["BS Computer Science", "BS Information Technology"],
      "CEA": ["BS Architecture", "BS Chemical Engineering", "BS Civil Engineering", "BS Computer Engineering", "BS Electrical Engineering", "BS Electronics Engineering", "BS Industrial Engineering", "BS Mechanical Engineering", "BS Mechanical Eng with Computational Science", "BS Mechanical Eng with Mechatronics", "BS Mining Engineering"],
      "CMBA": ["BS Accountancy", "BS Accounting Information Systems", "BS Management Accounting", "BS Business Administration", "Banking & Financial Management", "Business Analytics", "General Business Management", "Human Resource Management", "Marketing Management", "Operations Management", "Quality Management", "BS Hospitality Management", "BS Tourism Management", "BS Office Administration", "Bachelor in Public Administration"],
      "CAS": ["AB Communication", "AB English with Applied Linguistics", "Bachelor of Elementary Education", "Bachelor of Secondary Education", "Bachelor of Multimedia Arts", "BS Biology", "BS Math with Applied Industrial Mathematics", "BS Psychology"],
      "CNAHS": ["BS Nursing", "BS Pharmacy", "BS Medical Technology"],
      "CCJ": ["BS Criminology"]
    };

    const deptSelect = document.getElementById("department");
    const programSelect = document.getElementById("program");

    // Populate programs when department changes
    deptSelect.addEventListener("change", function() {
      const dept = this.value;
      programSelect.innerHTML = '<option value="">Select Program</option>';
      if (programsByDept[dept]) {
        programsByDept[dept].forEach(prog => {
          const option = document.createElement("option");
          option.value = prog;
          option.textContent = prog;
          programSelect.appendChild(option);
        });
      }
    });

    // Pre-fill from localStorage
    document.getElementById('fullName').value = localStorage.getItem('fullName') || '';
    document.getElementById('department').value = localStorage.getItem('department') || '';
    deptSelect.dispatchEvent(new Event('change'));
    programSelect.value = localStorage.getItem('program') || '';
    document.getElementById('yearLevel').value = localStorage.getItem('yearLevel') || '';

    // Update display info
    const updateDisplay = () => {
      document.getElementById('displayName').textContent = localStorage.getItem('fullName') || 'Student';
      document.getElementById('displayDept').textContent = localStorage.getItem('department') || 'Not set';
      document.getElementById('displayProgram').textContent = localStorage.getItem('program') || 'Not set';
      document.getElementById('displayYear').textContent = localStorage.getItem('yearLevel') ? localStorage.getItem('yearLevel') + getSuffix(localStorage.getItem('yearLevel')) + ' Year' : 'Not set';
    };

    const getSuffix = (num) => {
      if (num == 1) return 'st';
      if (num == 2) return 'nd';
      if (num == 3) return 'rd';
      return 'th';
    };

    updateDisplay();

    // Save form
    document.getElementById('profileForm').addEventListener('submit', (e) => {
      e.preventDefault();
      localStorage.setItem('fullName', document.getElementById('fullName').value);
      localStorage.setItem('department', document.getElementById('department').value);
      localStorage.setItem('program', document.getElementById('program').value);
      localStorage.setItem('yearLevel', document.getElementById('yearLevel').value);

      alert('Profile updated successfully!');
      window.location.href = '{% url "student_dashboard" %}';
    });

    // Logout functionality
    document.querySelectorAll('.logout-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        localStorage.clear();
        window.location.href = 'login-register.html';
      });
    });
  </script>
</body>
</html>